<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>AnnotationTrack class and methods — AnnotationTrack-class • Gviz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="AnnotationTrack class and methods — AnnotationTrack-class"><meta property="og:description" content="
  
A fairly generic track object for arbitrary genomic range annotations,
  with the option of grouped track items. The extended
  DetailsAnnotationTrack provides a more flexible interface to
  add user-defined custom information for each range."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Gviz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.39.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Gviz.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ivanek/Gviz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>AnnotationTrack class and methods</h1>
    
    <div class="hidden name"><code>AnnotationTrack-class.Rd</code></div>
    </div>

    <div class="ref-description">
    
  
<p>A fairly generic track object for arbitrary genomic range annotations,
  with the option of grouped track items. The extended
  <code>DetailsAnnotationTrack</code> provides a more flexible interface to
  add user-defined custom information for each range.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">AnnotationTrack</span><span class="op">(</span>range<span class="op">=</span><span class="cn">NULL</span>, start<span class="op">=</span><span class="cn">NULL</span>, end<span class="op">=</span><span class="cn">NULL</span>, width<span class="op">=</span><span class="cn">NULL</span>, <span class="va">feature</span>,
                <span class="va">group</span>, <span class="va">id</span>, <span class="va">strand</span>, <span class="va">chromosome</span>, <span class="va">genome</span>,
                stacking<span class="op">=</span><span class="st">"squish"</span>, name<span class="op">=</span><span class="st">"AnnotationTrack"</span>, <span class="va">fun</span>,
                <span class="va">selectFun</span>, <span class="va">importFunction</span>, stream<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="objects-from-the-class">
    <h2>Objects from the class</h2>
    
  
<p>Objects can be created using the constructor function
  <code>AnnotationTrack</code>.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <p><code>AnnotationTrack</code> object can be created from a variety of
  different inputs in order to nicely embed the package into the
  existing Bioconductor landscape. Since the main components of this
  class are essentially genomic ranges, the obvious Bioconductor
  representation is most likely a <code>GRanges</code> object,
  or, for grouped elements, a <code>GRangesList</code>. However,
  in certain cases it may be desirable to build the object from
  individual function arguments.</p>
<dl><dt>range</dt>
<dd>
    
<p>An optional meta argument to handle the different input types. If
    the <code>range</code> argument is missing, all the relevant information
    to create the object has to be provided as individual function
    arguments (see below).</p>
<p>The different input options for <code>range</code> are:</p>
<p></p><dl><dt></dt>
<dd><p>A <code>GRanges</code> object: the genomic ranges for the
    <code>Annotation</code> track as well as the optional additional
    metadata columns <code>feature</code>, <code>group</code> and
    <code>id</code> (see description of the individual function parameters
    below for details). Calling the constructor on a <code>GRanges</code>
    object without further arguments, e.g.
    <code>AnnotationTrack(range=obj)</code> is equivalent to calling the coerce
    method <code>as(obj, "AnnotationTrack")</code>.</p></dd>


      <dt></dt>
<dd><p>A <code>GRangesList</code> object: this is very similar to the
    previous case, except that the grouping information that is part
    of the list structure is preserved in the
    <code>AnnotationTrack</code>. I.e., all the elements within one list
    item receive the same group id. For consistancy, there is also a
    coercion method from <code>GRangesLists</code> <code>as(obj,
    "AnnotationTrack")</code>.</p></dd>


      <dt></dt>
<dd><p>An <code>IRanges</code> object: almost identical
    to the <code>GRanges</code> case, except that the chromosome and
    strand information as well as all additional metadata has to be
    provided in the separate <code>chromosome</code>, <code>strand</code>,
    <code>feature</code>, <code>group</code> or <code>id</code> arguments, because it
    can not be directly encoded in an <code>IRange</code> object. Note
    that none of those inputs are mandatory, and if not provided
    explicitely the more or less reasonable default values
    <code>chromosome=NA</code> and <code>strand="*"</code> are used.</p></dd>


      <dt></dt>
<dd><p>A <code>data.frame</code> object: the <code>data.frame</code> needs to
    contain at least the two mandatory columns <code>start</code> and
    <code>end</code> with the range coordinates. It may also contain a
    <code>chromosome</code> and a <code>strand</code> column with the chromosome
    and strand information for each range. If missing it will be
    drawn from the separate <code>chromosome</code> or <code>strand</code>
    arguments. In addition, the <code>feature</code>, <code>group</code> and
    <code>id</code> data can be provided as additional columns. The above
    comments about potential default values also apply here.</p></dd>


      <dt></dt>
<dd><p>A <code>character</code> scalar: in this case the value of the
    <code>range</code> argument is considered to be a file path to an
    annotation file on disk. A range of file types are supported by
    the <code>Gviz</code> package as identified by the file extension. See
    the <code>importFunction</code> documentation below for further
    details.</p></dd>


    
</dl><p></p></dd>
<dt>start, end, width</dt>
<dd><p>Integer vectors, giving the start and the end
    end coordinates for the individual track items, or their width. Two
    of the three need to be specified, and have to be of equal length or
    of length one, in which case this single value will be
    recycled. Otherwise, the usual R recycling rules for vectors do not
    apply here.</p></dd>
<dt>feature</dt>
<dd><p>Factor (or other vector that can be coerced into one),
    giving the feature types for the individual track items. When
    plotting the track to the device, if a display parameter with the
    same name as the value of <code>feature</code> is set, this will be used
    as the track item's fill color. See <code><a href="grouping.html">grouping</a></code> for
    details.  Needs to be of equal length as the provided genomic
    coordinates, or of length 1.</p></dd>
<dt>group</dt>
<dd><p>Factor (or other vector that can be coerced into one),
    giving the group memberships for the individual track items. When
    plotting to the device, all items in the same group will be
    connected.  See <code><a href="grouping.html">grouping</a></code> for details. Needs to be of
    equal length as the provided genomic coordinates, or of length 1.</p></dd>
<dt>id</dt>
<dd><p>Character vector of track item identifiers. When plotting to
    the device, it's value will be used as the identifier tag if the
    display parameter <code>showFeatureId=TRUE</code>. Needs to be of equal
    length as the provided genomic ranges, or of length 1.</p></dd>
<dt>strand</dt>
<dd><p>Character vector, the strand information for the
    individual track items. It may be provided in the form <code>+</code> for
    the Watson strand, <code>-</code> for the Crick strand or <code>*</code> for
    either one of the two. Needs to be of equal length as the provided
    genomic coordinates, or of length 1. Please note that grouped items
    need to be on the same strand, and erroneous entries will result in
    casting of an error.</p></dd>
<dt>chromosome</dt>
<dd><p>The chromosome on which the track's genomic ranges
    are defined. A valid UCSC chromosome identifier if
    <code>options(ucscChromosomeNames=TRUE)</code>. Please note that in this
    case only syntactic checking takes place, i.e., the argument value
    needs to be an integer, numeric character or a character of the form
    <code>chrx</code>, where <code>x</code> may be any possible string. The user has
    to make sure that the respective chromosome is indeed defined for
    the the track's genome. If not provided here, the constructor will
    try to construct the chromosome information based on the available
    inputs, and as a last resort will fall back to the value
    <code>chrNA</code>. Please note that by definition all objects in the
    <code>Gviz</code> package can only have a single active chromosome at a
    time (although internally the information for more than one
    chromosome may be present), and the user has to call the
    <code>chromosome&lt;-</code> replacement method in order to change to a
    different active chromosome.</p></dd>
<dt>genome</dt>
<dd><p>The genome on which the track's ranges are
    defined. Usually this is a valid UCSC genome identifier, however
    this is not being formally checked at this point. If not provided
    here the constructor will try to extract this information from the
    provided input, and eventually will fall back to the default value
    of <code>NA</code>.</p></dd>
<dt>stacking</dt>
<dd><p>The stacking type for overlapping items of the
    track. One in <code>c(hide, dense, squish, pack,full)</code>. Currently,
    only squish (make best use of the available space), dense (no
    stacking, collapse overlapping ranges), and hide (do not show any
    track items at all) are implemented.</p></dd>
<dt>name</dt>
<dd><p>Character scalar of the track's name used in the title
    panel when plotting.</p></dd>
<dt>fun</dt>
<dd><p>A function that is being called
    for each entry in the <code>AnnotationTrack</code> object. See section
    'Details' and 'Examples' for further information. When called
    internally by the plotting machinery, a number of arguments are
    automatically passed on to this function, and the user needs to make
    sure that they can all be digested (i.e., either have all of them as
    formal named function arguments, or gobble up everything that is not
    needed in ...). These arguments are:</p>    
<p></p><ul><li><p><code>start</code>: the genomic start coordinate of the range
    item.</p></li>
<li><p><code>end</code>: the genomic end coordinates of the range
    item.</p></li>
<li><p><code>strand</code>: the strand information for the range item.</p></li>
<li><p><code>chromosome</code>: the chromosome of the range item.</p></li>
<li><p><code>identifier</code>: the identifier of the range item, i.e.,
    the result of calling <code>identifier(DetailsAnnotationTrack,
      lowest=TRUE)</code>. Typically those identifiers are passed on to
    the object constructor during instantiation as the <code>id</code>
    argument.</p></li>
<li><p><code>index</code>: a counter enumerating the ranges. The
    <code>AnnotationTrack</code> object is sorted internally for
    visibility, and the <code>index</code> argument refers to the index
    of plotting.</p></li>
<li><p><code>GdObject</code>: a reference to the currently plotted
     <code>DetailsAnnotationTrack</code> object.</p></li>
<li><p><code>GdObject.original</code>: a reference to the
          <code>DetailsAnnotationTrack</code> before any processing like item
          collapsing has taken place. Essentially, this is the track
          object as it exists in your working environment.</p></li>
</ul><p>Additional arguments can be passed to the plotting function by means
    of the <code>detailsFunArgs</code> argument (see below). Note that the
    plot must use grid graphics (e.g. function in the 'lattice' package
    or low-level grid functions). To access a data object such a matrix
    or data frame within the function you can either store it as a
    variable in the global environment or, to avoid name space
    conflicts, you can make it part of the function environment by means
    of a closure. Alternatively, you may want to explicitely stick it
    into an environment or pass it along in the <code>detailsFunArgs</code>
    list. To figure out in your custom plotting function which
    annotation element is currently being plotted you can either use the
    identifier which has to be unique for each range element, or you may
    want to use the genomic position (start/end/strand/chromosome)
    e.g. if the data is stored in a <code>GRanges</code> object.</p>  
<p></p></dd>
<dt>selectFun</dt>
<dd><p>A function that is being called
    for each entry in the <code>AnnotationTrack</code> object with exactly
    the same arguments as in <code>fun</code>. The purpose of this function
    is to decide for each track element whether details should be
    drawn, and consequently it has to return a single logical
    scalar. If the return value is <code>TRUE</code>, details will be drawn
    for the item, if it is <code>FALSE</code>, the details strip for the
    item is omitted.</p>  
<p></p></dd>
<dt>importFunction</dt>
<dd><p>A user-defined function to be used to import the
    data from a file. This only applies when the <code>range</code> argument
    is a character string with the path to the input data file. The
    function needs to accept an argument <code>x</code> containing the file
    path and has to return a proper <code>GRanges</code> object with all the
    necessary metadata columns set. A set of default
    import functions is already implemented in the package for a number
    of different file types, and one of these defaults will be picked
    automatically based on the extension of the input file name. If the
    extension can not be mapped to any of the existing import function,
    an error is raised asking for a user-defined import function via
    this argument. Currently the following file types can be imported
    with the default functions: <code>gff</code>, <code>gff1</code>, <code>gff2</code>,
    <code>gff3</code>, <code>bed</code>, <code>bam</code>.</p></dd>
<dt>stream</dt>
<dd><p>A logical flag indicating that the user-provided import
    function can deal with indexed files and knows how to process the
    additional <code>selection</code> argument when accessing the data on
    disk. This causes the constructor to return a
    <code>ReferenceAnnotationTrack</code> object which will grab the necessary data
    on the fly during each plotting operation.</p></dd>
<dt>...</dt>
<dd><p>Additional items which will all be interpreted as further
    display parameters. See <code><a href="settings.html">settings</a></code> and the "Display
    Parameters" section below for details.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The return value of the constructor function is a new object of class
<code>AnnotationTrack</code> or of class <code>DetailsAnnotationTrack</code>,
  depending on the constructor arguments. Typically the user will not
  have to be troubled with this distinction and can rely on the
  constructor to make the right choice.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
    
<p>The <code>DetailsAnnotationTrack</code> class directly extends
  <code>AnnotationTrack</code>. The purpose of this track type is to add an
  arbitrarily detailed plot section (typically consisting of additional
  quantitative data) for each range element of an
  <code>AnnotationTrack</code>. This allows a locus wide view of annotation
  elements together with any kind of details per feature or element that
  may for instance provide insight on how some complex quantitative
  measurements change accoring to their position in a locus.  If the
  quantitative data is too complex for a <code>DataTrack</code> e.g. because
  it requires extra space or a trellis-like representation, a
  <code>DetailsAnnotationTrack</code> can be used instead. Example: An
  <code>AnnotationTrack</code> shows the positions of a number of probes from
  a microarray, and you want a histogram of the signal intensity
  distribution derived from all samples at each of these probe
  location. Another example usage would be to show for each element of
  an <code>AnnotationTrack</code> an xy-plot of the signal against some
  clinical measurement such as blood preassure. The limitation for
  applications of this type of track is basically only the available
  space of the device you are plotting to.</p>
<p>This flexibility is possible by utilizing a simple function model to
  perform all the detailed plotting. The functionality of this plotting
  function <code>fun</code> is totally up to the user, and the function
  environment is prepared in a way that all necessary information about
  the plotted annotation feature is available. To restrict the details
  section to only selected number of annotation features one can supply
  another function <code>selectFun</code>, which decides for each feature
  separatly whether details are available or not. Finally, an arbitrary
  number of additional arguments can be passed on to these two function
  by means of the <code>detailsFunArgs</code> display parameter. This is
  expected to be a named list, and all list elements are passed along to
  the plotting function <code>fun</code> and to the selector function
  <code>selectFun</code> as additional named arguments. Please note that some
  argument names like <code>start</code>, <code>end</code> or <code>identifier</code> are
  reserved and can not be used in the <code>detailsFunArgs</code> list. For
  examples of plotting functions, see the 'Examples' section.</p>
    </div>
    <div id="slots">
    <h2>Slots</h2>
    
  
<p></p><dl><dt><code>stacking</code>:</dt>
<dd><p>Object of class <code>"character"</code>,
      inherited from class <code><a href="StackedTrack-class.html">StackedTrack</a></code></p></dd>


    <dt><code>stacks</code>:</dt>
<dd><p>Object of class <code>"environment"</code>,
      inherited from class <code><a href="StackedTrack-class.html">StackedTrack</a></code></p></dd>


    <dt><code>range</code>:</dt>
<dd><p>Object of class <code>GRanges</code>,
      inherited from class <code><a href="RangeTrack-class.html">RangeTrack</a></code></p></dd>


    <dt><code>chromosome</code>:</dt>
<dd><p>Object of class <code>"character"</code>,
      inherited from class <code><a href="RangeTrack-class.html">RangeTrack</a></code></p></dd>


    <dt><code>genome</code>:</dt>
<dd><p>Object of class <code>"character"</code>, inherited
      from class <code><a href="RangeTrack-class.html">RangeTrack</a></code></p></dd>


    <dt><code>dp</code>:</dt>
<dd><p>Object of class
      <code><a href="DisplayPars-class.html">DisplayPars</a></code>, inherited from class
      <code><a href="GdObject-class.html">GdObject</a></code></p></dd>


    <dt><code>name</code>:</dt>
<dd><p>Object of class <code>"character"</code>, inherited
      from class <code><a href="GdObject-class.html">GdObject</a></code></p></dd>


    <dt><code>imageMap</code>:</dt>
<dd><p>Object of class
      <code><a href="ImageMap-class.html">ImageMap</a></code>, inherited from class
      <code><a href="GdObject-class.html">GdObject</a></code></p></dd>

  
    <dt><code>fun</code>:</dt>
<dd><p>A function that is being called for each
      <code>AnnotationTrack</code> element to plot details.</p></dd>


    <dt><code>selectFun</code>:</dt>
<dd><p>A function that is being called for each
      <code>AnnotationTrack</code> element to decide whether details need to
      be plotted.</p></dd>

  
  
</dl><p>Additional display parameters are being inherited from the
  <code><a href="StackedTrack-class.html">StackedTrack</a></code> parent class.</p>
    </div>
    <div id="extends">
    <h2>Extends</h2>
    
  
<p>Class <code>"<a href="StackedTrack-class.html">StackedTrack</a>"</code>, directly.</p>  
<p>Class <code>"<a href="RangeTrack-class.html">RangeTrack</a>"</code>, by class "StackedTrack", distance 2.</p>  
<p>Class <code>"<a href="GdObject-class.html">GdObject</a>"</code>, by class "StackedTrack",
  distance3.</p>
<p><code>DetailsAnnotationTrack</code> directly extends <code>AnnotationTrack</code>.</p>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    

<p>In the following code chunks, <code>obj</code> is considered to be an object
  of class <code>AnnotationTrack</code> or <code>DetailsAnnotationTrack</code>.</p>  
<p><b><em>Exported in the name space:</em></b></p>  
<p></p><dl><dt>group</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: extract
      the group membership for all track items.</p>      
<p><em>Usage:</em></p>        
<p><code>group(GdObject)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>group(obj)</code></p></dd>

    
      
</dl><p></p></dd>

        
    <dt>group&lt;-</dt>
<dd><p><code>signature(GdObject="AnnotationTrack",
      value="character")</code>: replace the grouping information for track
      items. The replacement value must be a factor of appropriate
      length or another vector that can be coerced into such.</p>
<p><em>Usage:</em></p>        
<p><code>group&lt;-(GdObject, value)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>group(obj) &lt;- c("a", "a", "b", "c", "a")</code></p></dd>


      
</dl><p></p></dd>

        
    <dt>identifier</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>:
      return track item identifiers. Depending on the setting of the
      optional argument <code>lowest</code>, these are either the group
      identifiers or the individual item identifiers.</p>
<p><em>Usage:</em></p>        
<p><code>identifier(GdObject, lowest=FALSE)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>lowest</code>: return the lowest-level identifier, i.e.,
    the item IDs, or the higher level group IDs which do not have to
    be unqiue.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>identifier(obj)</code></p></dd>

    
    <dt></dt>
<dd><p><code>identifier(obj, lowest=TRUE)</code></p></dd>


      
</dl><p></p></dd>

        
    <dt>identifier&lt;-</dt>
<dd><p><code>signature(GdObject="AnnotationTrack",
    value="character")</code>: Set the track item identifiers. The
      replacement value has to be a character vector of appropriate
      length. This always replaces the group-level identifiers, so
      essentially it is similar to <code>groups&lt;-</code>.</p>
<p><em>Usage:</em></p>        
<p><code>identifier&lt;-(GdObject, value)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>identifier(obj) &lt;- c("foo", "bar")</code></p></dd>


      
</dl><p></p></dd>

  
</dl><p><b><em>Internal methods:</em></b></p>  
<p></p><dl><dt>coerce</dt>
<dd><p><code>signature(from="AnnotationTrack",
    to="UCSCData")</code>: coerce to a <code>UCSCData</code> object for export to
      the UCSC genome browser.</p>
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>as(obj, "UCSCData")</code></p></dd>

    
      
</dl><p></p></dd>


    <dt>collapseTrack</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>:
      preprocess the track before plotting. This will collapse
      overlapping track items based on the available resolution and
      increase the width and height of all track objects to a minimum
      value to avoid rendering issues. See <code><a href="collapsing.html">collapsing</a></code> for
      details.</p>
<p><em>Usage:</em></p>
<p><code>collapseTrack(GdObject, diff=.pxResolution(coord="x"))</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>diff</code>: the minimum pixel width to display,
      everything below that will be inflated to a width of
      <code>diff</code>.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>Gviz:::collapseTrack(obj)</code></p></dd>

  
      
</dl><p></p></dd>


    <dt>drawGD</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: plot the
      object to a graphics device. The return value of this method is
      the input object, potentially updated during the plotting
      operation. Internally, there are two modes in which the method can
      be called. Either in 'prepare' mode, in which case no plotting is
      done but the object is preprocessed based on the
      available space, or in 'plotting' mode, in which case the actual
      graphical output is created. Since subsetting of the object can be
      potentially costly, this can be switched off in case subsetting
      has already been performed before or is not necessary.</p>      
<p><em>Usage:</em></p>
<p><code>drawGD(GdObject, minBase, maxBase, prepare=FALSE,
    subset=TRUE, ...)</code></p>      
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>minBase</code>, <code>maxBase</code>: the coordinate range to
      plot.</p></dd>


    <dt></dt>
<dd><p><code>prepare</code>: run method in preparation or in
      production mode.</p></dd>


    <dt></dt>
<dd><p><code>subset</code>: subset the object to the visible region
    or skip the potentially expensive subsetting operation.</p></dd>


    <dt></dt>
<dd><p><code>...</code>: all further arguments are ignored.</p></dd>


      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>Gviz:::drawGD(obj)</code></p></dd>

    
    <dt></dt>
<dd><p><code>Gviz:::drawGD(obj, minBase=1, maxBase=100)</code></p></dd>

    
    <dt></dt>
<dd><p><code>Gviz:::drawGD(obj, prepare=TRUE,
        subset=FALSE)</code></p></dd>

    
      
</dl><p></p></dd>


    <dt>drawGrid</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: superpose a grid on top of a track.</p>
<p><em>Usage:</em></p>      
<p><code>drawGrid(GdObject, from, to)</code></p>       
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>from</code>, <code>to</code>: integer scalars, draw grid
      within a certain coordinates range. This needs to be supplied
      for the plotting function to know the current genomic
      coordinates.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>Gviz:::drawGrid(obj, from=10, to=100)</code></p></dd>

    
      
</dl><p></p></dd>


    <dt>setStacks</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>:
      recompute the stacks based on the available space and on the
      object's track items and stacking settings.</p>
<p><em>Usage:</em></p>      
<p><code>setStacks(GdObject, from, to)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>from</code>, <code>to</code>: integer scalars, compute
      stacking within a certain coordinates range. This needs to be
      supplied for the plotting function to know the current genomic
      coordinates.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>Gviz:::setStacks(obj, from=1, to=100)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>initialize</dt>
<dd><p><code>signature(.Object="AnnotationTrack")</code>:
      initialize the object</p></dd>


    <dt>show</dt>
<dd><p><code>signature(object="AnnotationTrack")</code>: show a
      human-readable summary of the object</p></dd>

 
  
</dl><p><b><em>Inherited methods:</em></b></p>
<p></p><dl><dt>stacking</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: return
      the current stacking type.</p>        
<p><em>Usage:</em></p>      
<p><code>stacking(GdObject)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>stacking(obj)</code></p></dd>


      
</dl><p></p></dd>

        
    <dt>stacking&lt;-</dt>
<dd><p><code>signature(GdObject="AnnotationTrack",
      value="character")</code>: set the object's stacking type to one in
      <code>c(hide, dense, squish, pack,full)</code>.</p>        
<p><em>Usage:</em></p>      
<p><code>stacking&lt;-(GdObject, value)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>value</code>: replacement value.</p></dd>

      
    
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>stacking(obj) &lt;- "squish" </code></p></dd>


      
</dl><p></p></dd>


    <dt>stacks</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: return
      the stack indices for each track item.</p>      
<p><em>Usage:</em></p>      
<p><code>stacks(GdObject)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>Gviz:::stacks(obj)</code></p></dd>

    
      
</dl><p></p></dd>

    
    <dt>[</dt>
<dd><p><code>signature(x="AnnotationTrack", i="ANY", j="ANY",
    drop="ANY")</code>: subset the items in the <code>AnnotationTrack</code>
      object. This is essentially similar to subsetting of the
      <code>GRanges</code> object in the <code>range</code>
      slot. For most applications, the <code>subset</code> method may be
      more appropriate.</p>      
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>i</code>, <code>j</code>: subsetting indices, <code>j</code> is
      ignored.</p></dd>

    
    <dt></dt>
<dd><p><code>drop</code>: argument is ignored.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>obj[1:5]</code></p></dd>

    
      
</dl><p></p></dd>

      
      
    <dt>chromosome</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>:
       return the currently active chromosome for which the track is
       defined. For consistancy with other Bioconductor packages, the
       <code>isActiveSeq</code> alias is also provided.</p>      
<p><em>Usage:</em></p>      
<p><code>chromosome(GdObject)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>chromosome(obj)</code></p></dd>

    
      
</dl><p></p></dd>

    
    <dt>chromosome&lt;-</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>:
       replace the value of the track's active chromosome. This has to
       be a valid UCSC chromosome identifier or an integer or character
       scalar that can be reasonably coerced into one, unless
       <code>options(ucscChromosomeNames=FALSE)</code>. For consistancy with
       other Bioconductor packages, the <code>isActiveSeq&lt;-</code> alias is
       also provided.</p>      
<p><em>Usage:</em></p>      
<p><code>chromosome&lt;-(GdObject, value)</code></p>      
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>value</code>: replacement value.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>chromosome(obj) &lt;- "chr12"</code></p></dd>

    
      
</dl><p></p></dd>

    
    <dt>start, end, width</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: the
      start or end coordinates of the track items, or their width in
      genomic coordinates.</p>      
<p><em>Usage:</em></p>      
<p><code>start(x)</code></p>
<p><code>end(x)</code></p>
<p><code>width(x)</code></p>
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>start(obj)</code></p></dd>

    
    <dt></dt>
<dd><p><code>end(obj)</code></p></dd>

      
    <dt></dt>
<dd><p><code>width(obj)</code></p></dd>


      
</dl><p></p></dd>


    <dt>start&lt;-, end&lt;-, width&lt;-</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>:
      replace the start or end coordinates of the track items, or their
      width.</p>      
<p><em>Usage:</em></p>      
<p><code>start&lt;-(x, value)</code></p>
<p><code>end&lt;-(x, value)</code></p>
<p><code>width&lt;-(x, value)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>value</code>: replacement value.</p></dd>

      
    
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>start(obj) &lt;- 1:10</code></p></dd>

      
    <dt></dt>
<dd><p><code>end(obj) &lt;- 20:30</code></p></dd>

      
    <dt></dt>
<dd><p><code>width(obj) &lt;- 1</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>position</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: the
      arithmetic mean of the track item's coordionates, i.e.,
      <code>(end(obj)-start(obj))/2</code>.</p>
<p><em>Usage:</em></p>      
<p><code>position(GdObject)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>position(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>feature</dt>
<dd><p><code>signature(GdObject="AnnotationTrack")</code>: return the
      grouping information for track items. For certain sub-classes,
      groups may be indicated by different color schemes when
      plotting. See <code><a href="grouping.html">grouping</a></code> for details.</p>      
<p><em>Usage:</em></p>      
<p><code>feature(GdObject)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>feature(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>feature&lt;-</dt>
<dd><p><code>signature(gdObject="AnnotationTrack",
      value="character")</code>: set the grouping information for track
      items. This has to be a factor vector (or another type of vector
      that can be coerced into one) of the same length as the number of
      items in the <code>AnnotationTrack</code>. See <code><a href="grouping.html">grouping</a></code>
      for details.</p>      
<p><em>Usage:</em></p>      
<p><code>feature&lt;-(GdObject, value)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>value</code>: replacement value.</p></dd>

      
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>feature(obj) &lt;- c("a", "a", "b", "c", "a")</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>genome</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return the track's genome.</p>      
<p><em>Usage:</em></p>      
<p><code>genome(x)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>genome(obj)</code></p></dd>


      
</dl><p></p></dd>


    <dt>genome&lt;-</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: set the track's
      genome. Usually this has to be a valid UCSC identifier, however
      this is not formally enforced here.</p>        
<p><em>Usage:</em></p>      
<p><code>genome&lt;-(x, value)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>value</code>: replacement value.</p></dd>

      
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>genome(obj) &lt;- "mm9"</code></p></dd>


      
</dl><p></p></dd>


    <dt>length</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return the number
      of items in the track.</p>      
<p><em>Usage:</em></p>      
<p><code>length(x)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>length(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>range</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return the genomic
      coordinates for the track as an object of class
      <code>IRanges</code>.</p>      
<p><em>Usage:</em></p>      
<p><code>range(x)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>range(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>ranges</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return the genomic
      coordinates for the track along with all additional annotation
      information as an object of class <code>GRanges</code>.</p>      
<p><em>Usage:</em></p>      
<p><code>ranges(x)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>ranges(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>split</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: split a
      <code>AnnotationTrack</code> object by an appropriate factor vector (or
      another vector that can be coerced into one). The output of this
      operation is a list of objects of the same class as the input
      object, all inheriting from class <code>AnnotationTrack</code>.</p>      
<p><em>Usage:</em></p>      
<p><code>split(x, f, ...)</code></p>      
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>f</code>: the splitting factor.</p></dd>

    
    <dt></dt>
<dd><p><code>...</code>: all further arguments are ignored.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>split(obj, c("a", "a", "b", "c", "a"))</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>strand</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return a vector of
      strand specifiers for all track items, in the form '+' for the
      Watson strand, '-' for the Crick strand or '*' for either of the
      two.</p>      
<p><em>Usage:</em></p>      
<p><code>strand(x)</code></p>
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>strand(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>strand&lt;-</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: replace the
      strand information for the track items. The replacement value
      needs to be an appropriate scalar or vector of strand values.</p>      
<p><em>Usage:</em></p>      
<p><code>strand&lt;-(x, value)</code></p>      
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>value</code>: replacement value.</p></dd>

      
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>strand(obj) &lt;- "+"</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>values</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return all
      additional annotation information except for the genomic coordinates
      for the track items as a data.frame.</p>      
<p><em>Usage:</em></p>      
<p><code>values(x)</code></p>
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>values(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>coerce</dt>
<dd><p><code>signature(from="AnnotationTrack",
    to="data.frame")</code>: coerce the <code>GRanges</code>
    object in the <code>range</code> slot into a regular data.frame.</p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>as(obj, "data.frame")</code></p></dd>


      
</dl><p></p></dd>


    <dt>subset</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: subset a
      <code>AnnotationTrack</code> by coordinates and sort if necessary.</p>      
<p><em>Usage:</em></p>        
<p><code>subset(x, from, to, sort=FALSE, ...)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>from</code>, <code>to</code>: the coordinates range to subset
      to.</p></dd>

    
    <dt></dt>
<dd><p><code>sort</code>: sort the object after subsetting. Usually
      not necessary.</p></dd>

    
    <dt></dt>
<dd><p><code>...</code>: additional arguments are ignored.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>subset(obj, from=10, to=20, sort=TRUE)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>displayPars</dt>
<dd><p><code>signature(x="AnnotationTrack",
      name="character")</code>: list the value of the display parameter
      <code>name</code>. See <code><a href="settings.html">settings</a></code> for details on display
      parameters and customization.</p>      
<p><em>Usage:</em></p>      
<p><code>displayPars(x, name)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>displayPars(obj, "col")</code></p></dd>

    
      
</dl><p></p></dd>

      
    
    <dt>displayPars</dt>
<dd><p><code>signature(x="AnnotationTrack",
      name="missing")</code>: list the value of all available display
      parameters. See <code><a href="settings.html">settings</a></code> for details on display
      parameters and customization.</p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>displayPars(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>getPar</dt>
<dd><p><code>signature(x="AnnotationTrack", name="character")</code>:
      alias for the <code>displayPars</code> method. See
      <code><a href="settings.html">settings</a></code> for details on display parameters and
      customization.</p>
<p><em>Usage:</em></p>      
<p><code>getPar(x, name)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>getPar(obj, "col")</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>getPar</dt>
<dd><p><code>signature(x="AnnotationTrack", name="missing")</code>:
      alias for the <code>displayPars</code> method. See
      <code><a href="settings.html">settings</a></code> for details on display parameters and
      customization.</p>  
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>getPar(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>displayPars&lt;-</dt>
<dd><p><code>signature(x="AnnotationTrack",
      value="list")</code>: set display parameters using the values of the
      named list in <code>value</code>. See <code><a href="settings.html">settings</a></code> for details
      on display parameters and customization.</p>      
<p><em>Usage:</em></p>      
<p><code>displayPars&lt;-(x, value)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>displayPars(obj) &lt;- list(col="red", lwd=2)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>setPar</dt>
<dd><p><code>signature(x="AnnotationTrack", value="character")</code>:
      set the single display parameter <code>name</code> to <code>value</code>. Note
      that display parameters in the <code>AnnotationTrack</code> class are
      pass-by-reference, so no re-assignmnet to the symbol <code>obj</code> is
      necessary. See <code><a href="settings.html">settings</a></code> for details on display
      parameters and customization.</p>      
<p><em>Usage:</em></p>      
<p><code>setPar(x, name, value)</code></p>
<p><em>Additional Arguments:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>name</code>: the name of the display parameter to set.</p></dd>

    
      
</dl><p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>setPar(obj, "col", "red")</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>setPar</dt>
<dd><p><code>signature(x="AnnotationTrack", value="list")</code>: set
      display parameters by the values of the named list in
      <code>value</code>.  Note that display parameters in the
      <code>AnnotationTrack</code> class are pass-by-reference, so no
      re-assignmnet to the symbol <code>obj</code> is necessary. See
      <code><a href="settings.html">settings</a></code> for details on display parameters and
      customization.</p>      
       
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>setPar(obj, list(col="red", lwd=2))</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>names</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return the value of
      the <code>name</code> slot.</p>      
<p><em>Usage:</em></p>      
<p><code>names(x)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>names(obj)</code></p></dd>


      
</dl><p></p></dd>

    
    <dt>names&lt;-</dt>
<dd><p><code>signature(x="AnnotationTrack", value="character")</code>:
      set the value of the <code>name</code> slot.</p>      
<p><em>Usage:</em></p>      
<p><code>names&lt;-(x, value)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>names(obj) &lt;- "foo"</code></p></dd>


      
</dl><p></p></dd>


    <dt>coords</dt>
<dd><p><code>signature(ImageMap="AnnotationTrack")</code>: return the
      coordinates from the internal image map.</p>      
<p><em>Usage:</em></p>      
<p><code>coords(ImageMap)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>coords(obj)</code></p></dd>


      
</dl><p></p></dd>


    <dt>tags</dt>
<dd><p><code>signature(x="AnnotationTrack")</code>: return the tags from the
      internal image map.</p>      
<p><em>Usage:</em></p>      
<p><code>tags(x)</code></p>      
<p><em>Examples:</em></p>      
<p></p><dl><dt></dt>
<dd><p><code>tags(obj)</code></p></dd>


      
</dl><p></p></dd>

  
</dl></div>
    <div id="display-parameters">
    <h2>Display Parameters</h2>
     

<p>The following display parameters are set for objects of class
  <code>AnnotationTrack</code> upon instantiation, unless one or more of them
  have already been set by one of the optional sub-class initializers,
  which always get precedence over these global defaults. See
  <code><a href="settings.html">settings</a></code> for details on setting graphical parameters
  for tracks.</p><dl><dt></dt>
<dd><p><code>arrowHeadMaxWidth=40</code>: Numeric scalar. The maximum
      width of the arrow head in pixels if <code>shape</code> is <code>arrow</code>.</p></dd>
 

    <dt></dt>
<dd><p><code>arrowHeadWidth=30</code>: Numeric scalar. The width of the
      arrow head in pixels if <code>shape</code> is <code>fixedArrow</code>.</p></dd>
 

    <dt></dt>
<dd><p><code>cex=1</code>: Numeric scalar. The font expansion factor
      for item identifiers.</p></dd>
 

    <dt></dt>
<dd><p><code>cex.group=0.6</code>: Numeric scalar. The font expansion
      factor for the group-level annotation.</p></dd>
 

    <dt></dt>
<dd><p><code>col="transparent"</code>: Character or integer scalar. The
      border color for all track items.</p></dd>
 

    <dt></dt>
<dd><p><code>col.line="darkgray"</code>: Character scalar. The color
      used for connecting lines between grouped items. Defaults to a
      light gray, but if set to <code>NULL</code> the same color as for the
      first item in the group is used.</p></dd>
 

    <dt></dt>
<dd><p><code>featureAnnotation=NULL</code>: Character scalar. Add
      annotation information to the individual track elements. This
      can be a value in <code>id</code>, <code>group</code> or <code>feature</code>.
      Defaults to <code>id</code>. Only works if <code>showFeatureId</code> is not
      <code>FALSE</code>.</p></dd>
 

    <dt></dt>
<dd><p><code>fill="lightblue"</code>: Character or integer scalar. The
      fill color for untyped items. This is also used to connect grouped
      items. See <code><a href="grouping.html">grouping</a></code> for details.</p></dd>
 

    <dt></dt>
<dd><p><code>fontcolor.group="#808080"</code> <code>(Aliases:
      fontcolor.group)</code>: Character or integer scalar. The font color
      for the group-level annotation.</p></dd>
 

    <dt></dt>
<dd><p><code>fontcolor.item="white"</code> <code>(Aliases: fontcolor.item)</code>:
      Character or integer scalar. The font color for item identifiers.</p></dd>
 

    <dt></dt>
<dd><p><code>fontface.group=2</code>: Numeric scalar. The font face for
      the group-level annotation.</p></dd>
 

    <dt></dt>
<dd><p><code>fontfamily.group="sans"</code>: Character scalar. The font
      family for the group-level annotation.</p></dd>
 

    <dt></dt>
<dd><p><code>fontsize.group=12</code>: Numeric scalar. The font size
      for the group-level annotation.</p></dd>
 

    <dt></dt>
<dd><p><code>groupAnnotation=NULL</code>: Character scalar. Add annotation
      information as group labels. This can be a value in <code>id</code>,
      <code>group</code> or <code>feature</code>. Defaults to <code>group</code>. Only
      works if <code>showId</code> is not <code>FALSE</code>.</p></dd>
 

    <dt></dt>
<dd><p><code>just.group="left"</code> <code>(Aliases: just.group)</code>:
      Character scalar. the justification of group labels. Either
      <code>left</code>, <code>right</code>, <code>above</code> or <code>below</code>.</p></dd>
 

    <dt></dt>
<dd><p><code>lex=1</code>: Numeric scalar. The line expansion factor
      for all track items. This is also used to connect grouped items.
      See <code><a href="grouping.html">grouping</a></code> for details.</p></dd>
 

    <dt></dt>
<dd><p><code>lineheight=1</code>: Numeric scalar. The font line height
      for item identifiers.</p></dd>
 

    <dt></dt>
<dd><p><code>lty="solid"</code>: Character or integer scalar. The line
      type for all track items. This is also used to connect grouped
      items. See <code><a href="grouping.html">grouping</a></code> for details.</p></dd>
 

    <dt></dt>
<dd><p><code>lwd=1</code>: Integer scalar. The line width for all track
      items. This is also used to connect grouped items. See
      <code><a href="grouping.html">grouping</a></code> for details.</p></dd>
 

    <dt></dt>
<dd><p><code>mergeGroups=FALSE</code>: Logical scalar. Merge fully
      overlapping groups if <code>collapse==TRUE</code>.</p></dd>
 

    <dt></dt>
<dd><p><code>min.height=3</code>: Numeric scalar. The minimum range
      height in pixels to display. All ranges are expanded to this size
      in order to avoid rendering issues. See <code><a href="collapsing.html">collapsing</a></code>
      for details. For feathered bars indicating the strandedness of
      grouped items this also controls the height of the arrow feathers.</p></dd>
 

    <dt></dt>
<dd><p><code>min.width=1</code>: Numeric scalar. The minimum range width
      in pixels to display. All ranges are expanded to this size in
      order to avoid rendering issues. See <code><a href="collapsing.html">collapsing</a></code>
      for details.</p></dd>
 

    <dt></dt>
<dd><p><code>rotation=0</code>: Numeric scalar. The degree of text
      rotation for item identifiers.</p></dd>
 

    <dt></dt>
<dd><p><code>rotation.group=0</code>: Numeric scalar. The degree of text
      rotation for group labels.</p></dd>
 

    <dt></dt>
<dd><p><code>rotation.item=0</code>: Numeric scalar. The degree of text
      rotation for item identifiers.</p></dd>
 

    <dt></dt>
<dd><p><code>shape="arrow"</code>: Character scalar. The shape in which
      to display the track items. Currently only <code>box</code>, <code>arrow</code>,
      <code>fixedArrow</code>, <code>ellipse</code>, and <code>smallArrow</code> are
      implemented.</p></dd>
 

    <dt></dt>
<dd><p><code>showFeatureId=FALSE</code>: Logical scalar. Control whether
      to plot the individual track item identifiers.</p></dd>
 

    <dt></dt>
<dd><p><code>showId=FALSE</code>: Logical scalar. Control whether to
      annotate individual groups.</p></dd>
 

    <dt></dt>
<dd><p><code>showOverplotting=FALSE</code>: Logical scalar. Use a color
      gradient to show the amount of overplotting for collapsed items.
      This implies that <code>collapse==TRUE</code></p></dd>
 

    <dt></dt>
<dd><p><code>size=1</code>: Numeric scalar. The relative size of the
      track. Can be overridden in the <code><a href="plotTracks.html">plotTracks</a></code> function.</p></dd>
 

  
</dl><p><code>DetailsAnnotationTrack</code> adds the following additional display
  parameters:</p><dl><dt></dt>
<dd><p><code>details.minWidth=100</code>: Numeric scalar. The minium
      width in pixels for a details panel, if less space is available
      no details are plotted.</p></dd>
 

    <dt></dt>
<dd><p><code>details.ratio=Inf</code>: Numeric scalar. By default, the
      plotting method tries to fill all available space of the details
      panel tiles. Depending on the dimensions of your plot and the
      number of tiles this may lead to fairly stretched plots. Restricting
      the ration of width over height can help to fine tune for somewhat
      more sane graphics in these cases. Essentially this adds some
      white space in between individual tiles to force the desired
      ratio. Together with the <code>size</code> and <code>details.size</code>
      arguments, which control the vertical extension of the whole
      track and of the details section, this allows for some fairly
      generic resizing of the tiles.</p></dd>
 

    <dt></dt>
<dd><p><code>details.size=0.5</code>: Numeric scalar. The fraction of
      vertical space of the track used for the details section.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsBorder.col="darkgray"</code>: Character or integer
      scalar. Line color of the border.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsBorder.fill="transparent"</code>: Character or
      integer scalar. Background color of the border.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsBorder.lty="solid"</code>: Character or integer
      scalar. Line type of the border around each details panel.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsBorder.lwd=1</code>: Integer scalar. Line width of
      the border.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsConnector.cex=1</code>: Numeric scalar. Relative
      size of the connector's end points.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsConnector.col="darkgray"</code>: Character or integer
      scalar. Color of the line connecting the <code>AnnotstionTrack</code>
      item with its details panel.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsConnector.lty="dashed"</code>: Character or integer
      scalar. Type of connecting line.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsConnector.lwd=1</code>: Integer scalar. Line width
      of the connector.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsConnector.pch=20</code>: Integer scalar. Type of
      the connector's ends.</p></dd>
 

    <dt></dt>
<dd><p><code>detailsFunArgs=character(0)</code>: List.Additional arguments
      that get passed on the the details plotting function.</p></dd>
 

    <dt></dt>
<dd><p><code>groupDetails=FALSE</code>: Logial scalar. Plot details for
      feature groups rather than for individual features.</p></dd>
 

  
</dl><p>Additional display parameters are being inherited from the respective
  parent classes. Note that not all of them may have an effect on the
  plotting of <code>AnnotationTrack</code> objects.</p>
<p></p><dl><dt></dt>
<dd><p><code><a href="StackedTrack-class.html">StackedTrack</a></code>:</p>
<p></p><dl><dt></dt>
<dd><p><code>reverseStacking=FALSE</code>: Logical flag. Reverse
          the y-ordering of stacked items. I.e., features that are
          plotted on the bottom-most stacks will be moved to the top-most
          stack and vice versa.</p></dd>
 

        <dt></dt>
<dd><p><code>stackHeight=0.75</code>: Numeric between 0 and 1.
          Controls the vertical size and spacing between stacked
          elements. The number defines the proportion of the total
          available space for the stack that is used to draw the glyphs.
          E.g., a value of 0.5 means that half of the available vertical
          drawing space (for each stacking line) is used for the glyphs,
          and thus one quarter of the available space each is used for
          spacing above and below the glyph. Defaults to 0.75.</p></dd>
 

      
</dl><p></p></dd>
 

    <dt></dt>
<dd><p><code><a href="GdObject-class.html">GdObject</a></code>:</p>
<p></p><dl><dt></dt>
<dd><p><code>alpha=1</code>: Numeric scalar. The transparency for
          all track items.</p></dd>
 

        <dt></dt>
<dd><p><code>alpha.title=NULL</code>: Numeric scalar. The transparency
          for the title panel.</p></dd>
 

        <dt></dt>
<dd><p><code>background.legend="transparent"</code>: Integer or
          character scalar. The background color for the legend.</p></dd>
 

        <dt></dt>
<dd><p><code>background.panel="transparent"</code>: Integer or
          character scalar. The background color of the content panel.</p></dd>
 

        <dt></dt>
<dd><p><code>background.title="lightgray"</code>: Integer or character
          scalar. The background color for the title panel.</p></dd>
 

        <dt></dt>
<dd><p><code>cex.axis=NULL</code>: Numeric scalar. The expansion
          factor for the axis annotation. Defaults to <code>NULL</code>, in
          which case it is automatically determined based on the
          available space.</p></dd>
 

        <dt></dt>
<dd><p><code>cex.title=NULL</code>: Numeric scalar. The expansion
          factor for the title panel. This effects the fontsize of both
          the title and the axis, if any. Defaults to <code>NULL</code>,
          which means that the text size is automatically adjusted to
          the available space.</p></dd>
 

        <dt></dt>
<dd><p><code>col.axis="white"</code>: Integer or character scalar.
          The font and line color for the y axis, if any.</p></dd>
 

        <dt></dt>
<dd><p><code>col.border.title="white"</code>: Integer or character
          scalar. The border color for the title panels.</p></dd>
 

        <dt></dt>
<dd><p><code>col.frame="lightgray"</code>: Integer or character
          scalar. The line color used for the panel frame, if
          <code>frame==TRUE</code></p></dd>
 

        <dt></dt>
<dd><p><code>col.grid="#808080"</code>: Integer or character scalar.
          Default line color for grid lines, both when <code>type=="g"</code>
          in <code><a href="DataTrack-class.html">DataTrack</a></code>s and when display parameter
          <code>grid==TRUE</code>.</p></dd>
 

        <dt></dt>
<dd><p><code>col.symbol=NULL</code>: Integer or character scalar.
          Default colors for plot symbols. Usually the same as the
          global <code>col</code> parameter.</p></dd>
 

        <dt></dt>
<dd><p><code>col.title="white"</code> <code>(Aliases: fontcolor.title)</code>:
          Integer or character scalar. The border color for the title panels</p></dd>
 

        <dt></dt>
<dd><p><code>collapse=TRUE</code>: Boolean controlling whether to
          collapse the content of the track to accomodate the minimum
          current device resolution. See <code><a href="collapsing.html">collapsing</a></code> for
          details.</p></dd>
 

        <dt></dt>
<dd><p><code>fontcolor="black"</code>: Integer or character scalar.
          The font color for all text, unless a more specific definition
          exists.</p></dd>
 

        <dt></dt>
<dd><p><code>fontface=1</code>: Integer or character scalar. The
          font face for all text, unless a more specific definition exists.</p></dd>
 

        <dt></dt>
<dd><p><code>fontface.title=2</code>: Integer or character scalar.
          The font face for the title panels.</p></dd>
 

        <dt></dt>
<dd><p><code>fontfamily="sans"</code>: Integer or character scalar.
          The font family for all text, unless a more specific definition
          exists.</p></dd>
 

        <dt></dt>
<dd><p><code>fontfamily.title="sans"</code>: Integer or character
          scalar. The font family for the title panels.</p></dd>
 

        <dt></dt>
<dd><p><code>fontsize=12</code>: Numeric scalar. The font size for
          all text, unless a more specific definition exists.</p></dd>
 

        <dt></dt>
<dd><p><code>frame=FALSE</code>: Boolean. Draw a frame around the
          track when plotting.</p></dd>
 

        <dt></dt>
<dd><p><code>grid=FALSE</code>: Boolean, switching on/off the plotting
          of a grid.</p></dd>
 

        <dt></dt>
<dd><p><code>h=-1</code>: Integer scalar. Parameter controlling the
          number of horizontal grid lines, see <code><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.grid</a></code>
          for details.</p></dd>
 

        <dt></dt>
<dd><p><code>lty.grid="solid"</code>: Integer or character scalar.
          Default line type for grid lines, both when <code>type=="g"</code>
          in <code><a href="DataTrack-class.html">DataTrack</a></code>s and when display parameter
          <code>grid==TRUE</code>.</p></dd>
 

        <dt></dt>
<dd><p><code>lwd.border.title=1</code>: Integer scalar. The border
          width for the title panels.</p></dd>
 

        <dt></dt>
<dd><p><code>lwd.grid=1</code>: Numeric scalar. Default line width
          for grid lines, both when <code>type=="g"</code> in <code><a href="DataTrack-class.html">DataTrack</a></code>s
          and when display parameter <code>grid==TRUE</code>.</p></dd>
 

        <dt></dt>
<dd><p><code>lwd.title=1</code>: Integer scalar. The border width
          for the title panels</p></dd>
 

        <dt></dt>
<dd><p><code>min.distance=1</code>: Numeric scalar. The minimum
          pixel distance before collapsing range items, only if
          <code>collapse==TRUE</code>. See <code><a href="collapsing.html">collapsing</a></code> for details.</p></dd>
 

        <dt></dt>
<dd><p><code>reverseStrand=FALSE</code>: Logical scalar. Set up the
          plotting coordinates in 3' -&gt; 5' direction if <code>TRUE</code>.
          This will effectively mirror the plot on the vertical axis.</p></dd>
 

        <dt></dt>
<dd><p><code>rotation.title=90</code> <code>(Aliases: rotation.title)</code>:
          The rotation angle for the text in the title panel. Even
          though this can be adjusted, the automatic resizing of the
          title panel will currently not work, so use at own risk.</p></dd>
 

        <dt></dt>
<dd><p><code>showAxis=TRUE</code>: Boolean controlling whether to
          plot a y axis (only applies to track types where axes are
          implemented).</p></dd>
 

        <dt></dt>
<dd><p><code>showTitle=TRUE</code>: Boolean controlling whether to
          plot a title panel. Although this can be set individually
          for each track, in multi-track plots as created by
          <code><a href="plotTracks.html">plotTracks</a></code> there will still be an empty
          placeholder in case any of the other tracks include a title.
          The same holds true for axes. Note that the the title panel
          background color could be set to transparent in order to
          completely hide it.</p></dd>
 

        <dt></dt>
<dd><p><code>v=-1</code>: Integer scalar. Parameter controlling the
          number of vertical grid lines, see <code><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.grid</a></code>
          for details.</p></dd>
 

      
</dl><p></p></dd>
 

  
</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Florian Hahne, Arne Mueller</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">

<p><code><a href="DisplayPars-class.html">DisplayPars</a></code></p>
<p><code><a href="GdObject-class.html">GdObject</a></code></p>
<p><code>GRanges</code></p>
<p><code>GRangesList</code></p>
<p><code><a href="ImageMap-class.html">ImageMap</a></code></p>
<p><code>IRanges</code></p>
<p><code><a href="RangeTrack-class.html">RangeTrack</a></code></p>
<p><code><a href="StackedTrack-class.html">StackedTrack</a></code></p>
<p><code><a href="collapsing.html">collapsing</a></code></p>
<p><code><a href="DataTrack-class.html">DataTrack</a></code></p>
<p><code><a href="grouping.html">grouping</a></code></p>
<p><code><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.grid</a></code></p>
<p><code><a href="plotTracks.html">plotTracks</a></code></p>
<p><code><a href="settings.html">settings</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## An empty object</span></span>
<span class="r-in"><span class="fu">AnnotationTrack</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AnnotationTrack 'AnnotationTrack'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | genome: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | active chromosome: chrNA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | annotation features: 0</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Construct from individual arguments</span></span>
<span class="r-in"><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000000</span>, <span class="fl">2070000</span>, <span class="fl">2100000</span>, <span class="fl">2160000</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2050000</span>, <span class="fl">2130000</span>, <span class="fl">2150000</span>, <span class="fl">2170000</span><span class="op">)</span></span>
<span class="r-in"><span class="va">str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"+"</span>, <span class="st">"-"</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group1"</span>,<span class="st">"Group2"</span>,<span class="st">"Group1"</span>, <span class="st">"Group3"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">annTrack</span> <span class="op">&lt;-</span> <span class="fu">AnnotationTrack</span><span class="op">(</span>start<span class="op">=</span><span class="va">st</span>, end<span class="op">=</span><span class="va">ed</span>, strand<span class="op">=</span><span class="va">str</span>, chromosome<span class="op">=</span><span class="fl">7</span>, </span>
<span class="r-in">                            genome<span class="op">=</span><span class="st">"hg19"</span>, feature<span class="op">=</span><span class="st">"test"</span>, group<span class="op">=</span><span class="va">gr</span>, </span>
<span class="r-in">                            id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"annTrack item"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, </span>
<span class="r-in">                            name<span class="op">=</span><span class="st">"generic annotation"</span>, stacking<span class="op">=</span><span class="st">"squish"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Or from a data.frame</span></span>
<span class="r-in"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="va">st</span>, end<span class="op">=</span><span class="va">ed</span>, strand<span class="op">=</span><span class="va">str</span>, id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"annTrack item"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, </span>
<span class="r-in">                 feature<span class="op">=</span><span class="st">"test"</span>, group<span class="op">=</span><span class="va">gr</span><span class="op">)</span></span>
<span class="r-in"><span class="va">annTrack</span> <span class="op">&lt;-</span> <span class="fu">AnnotationTrack</span><span class="op">(</span>range<span class="op">=</span><span class="va">df</span>, genome<span class="op">=</span><span class="st">"hg19"</span>, chromosome<span class="op">=</span><span class="fl">7</span>, </span>
<span class="r-in">                            name<span class="op">=</span><span class="st">"generic annotation"</span>, stacking<span class="op">=</span><span class="st">"squish"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Or from a GRanges object</span></span>
<span class="r-in"><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames<span class="op">=</span><span class="st">"chr7"</span>, range<span class="op">=</span><span class="fu">IRanges</span><span class="op">(</span>start<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">start</span>, end<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">end</span><span class="op">)</span>, </span>
<span class="r-in">              strand<span class="op">=</span><span class="va">str</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">genome</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"hg19"</span></span>
<span class="r-in"><span class="fu">mcols</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">annTrack</span> <span class="op">&lt;-</span> <span class="fu">AnnotationTrack</span><span class="op">(</span>range<span class="op">=</span><span class="va">gr</span>, name<span class="op">=</span><span class="st">"generic annotation"</span>, </span>
<span class="r-in">                            stacking<span class="op">=</span><span class="st">"squish"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Finally from a GRangesList</span></span>
<span class="r-in"><span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gr</span>, <span class="fu">values</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">AnnotationTrack</span><span class="op">(</span><span class="va">grl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AnnotationTrack 'AnnotationTrack'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | genome: hg19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | active chromosome: chr7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | annotation features: 4</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># \dontshow{</span></span>
<span class="r-in"><span class="co">## For some annoying reason the postscript device does not know about</span></span>
<span class="r-in"><span class="co">## the sans font</span></span>
<span class="r-in"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">{</span></span>
<span class="r-in"><span class="va">font</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/ps.options.html" class="external-link">ps.options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">family</span></span>
<span class="r-in"><span class="fu"><a href="DisplayPars-class.html">displayPars</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fontfamily<span class="op">=</span><span class="va">font</span>, fontfamily.title<span class="op">=</span><span class="va">font</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plotting</span></span>
<span class="r-in"><span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Track names</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "generic annotation"</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"foo"</span></span>
<span class="r-in"><span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Subsetting and splitting</span></span>
<span class="r-in"><span class="va">subTrack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">annTrack</span>, to<span class="op">=</span><span class="fl">2155000</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span class="va">subTrack</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AnnotationTrack 'foo'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | genome: hg19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | active chromosome: chr7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | annotation features: 2</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">annTrack</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AnnotationTrack 'foo'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | genome: hg19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | active chromosome: chr7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | annotation features: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AnnotationTrack 'foo'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | genome: hg19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | active chromosome: chr7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | annotation features: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Accessors</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2000000 2070000 2100000 2160000</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2050000 2130000 2150000 2170000</span>
<span class="r-in"><span class="fu">width</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50001 60001 50001 10001</span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">position</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2025000 2100000 2125000 2165000</span>
<span class="r-in"><span class="fu">width</span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">width</span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span><span class="op">+</span><span class="fl">1000</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">strand</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-" "+" "-" "-"</span>
<span class="r-in"><span class="fu">strand</span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">chromosome</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "chr7"</span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">chromosome</a></span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"chrX"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">genome</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   chr7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "hg19" </span>
<span class="r-in"><span class="fu">genome</span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"mm9"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">range</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IRanges object with 4 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           start       end     width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   2000000   2050000     50001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]   2070000   2130000     60001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]   2100000   2150000     50001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]   2160000   2170000     10001</span>
<span class="r-in"><span class="fu">ranges</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 4 ranges and 4 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames          ranges strand |     feature       group              id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;     &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr7 2000000-2050000      - |        test      Group1 annTrack item 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr7 2070000-2130000      + |        test      Group2 annTrack item 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr7 2100000-2150000      - |        test      Group1 annTrack item 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr7 2160000-2170000      - |        test      Group3 annTrack item 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from hg19 genome; no seqlengths</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Annotation</span></span>
<span class="r-in"><span class="fu">identifier</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Group1" "Group2" "Group1" "Group3"</span>
<span class="r-in"><span class="fu">identifier</span><span class="op">(</span><span class="va">annTrack</span>, <span class="st">"lowest"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "annTrack item 1" "annTrack item 2" "annTrack item 3" "annTrack item 4"</span>
<span class="r-in"><span class="fu">identifier</span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"bar"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">feature</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "test" "test" "test" "test"</span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">feature</a></span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"foo"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">values</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   feature  group              id density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    test Group1 annTrack item 1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    test Group2 annTrack item 2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    test Group1 annTrack item 3       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    test Group3 annTrack item 4       1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Grouping</span></span>
<span class="r-in"><span class="fu">group</span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Group1" "Group2" "Group1" "Group3"</span>
<span class="r-in"><span class="fu">group</span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Group 1"</span></span>
<span class="r-in"><span class="fu"><a href="RangeTrack-class.html">chromosome</a></span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"chr7"</span></span>
<span class="r-in"><span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">subTrack</span><span class="op">)</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Stacking</span></span>
<span class="r-in"><span class="fu"><a href="StackedTrack-class.html">stacking</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "squish"</span>
<span class="r-in"><span class="fu"><a href="StackedTrack-class.html">stacking</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"dense"</span></span>
<span class="r-in"><span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## coercion</span></span>
<span class="r-in"><span class="fu">as</span><span class="op">(</span><span class="va">annTrack</span>, <span class="st">"data.frame"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X.seqnames X.start   X.end X.width X.strand X.feature X.group            X.id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       chr7 2000000 2050000   50001        -      test  Group1 annTrack item 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       chr7 2070000 2130000   60001        +      test  Group2 annTrack item 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       chr7 2100000 2150000   50001        -      test  Group1 annTrack item 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       chr7 2160000 2170000   10001        -      test  Group3 annTrack item 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X.density feature  group              id density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1    test Group1 annTrack item 1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1    test Group2 annTrack item 2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1    test Group1 annTrack item 3       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1    test Group3 annTrack item 4       1</span>
<span class="r-in"><span class="fu">as</span><span class="op">(</span><span class="va">annTrack</span>, <span class="st">"UCSCData"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> UCSC track 'foo'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> UCSCData object with 4 ranges and 3 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames          ranges strand |              id            name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; |     &lt;character&gt;     &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr7 2000000-2050000      - | annTrack_item_1 annTrack_item_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr7 2070000-2130000      + | annTrack_item_2 annTrack_item_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr7 2100000-2150000      - | annTrack_item_3 annTrack_item_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr7 2160000-2170000      - | annTrack_item_4 annTrack_item_4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           itemRgb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   lightblue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]   lightblue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]   lightblue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]   lightblue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## HTML image map</span></span>
<span class="r-in"><span class="fu"><a href="GdObject-class.html">coords</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span class="fu"><a href="GdObject-class.html">tags</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span class="va">annTrack</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span><span class="op">$</span><span class="va">foo</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="GdObject-class.html">coords</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        x1   y1       x2    y2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1  38.31359 64.5 164.3644 415.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 3 290.41525 64.5 416.4661 415.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 2 214.78475 64.5 366.0457 415.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 4 441.67625 64.5 466.8864 415.5</span>
<span class="r-in"><span class="fu"><a href="GdObject-class.html">tags</a></span><span class="op">(</span><span class="va">annTrack</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fill</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "lightblue"     "lightblue"     "lightblue"     "lightblue" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "-"             "-"             "+"             "-" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   annTrack item 1   annTrack item 3   annTrack item 2   annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "annTrack item 1" "annTrack item 3" "annTrack item 2" "annTrack item 4" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "2000000"       "2100000"       "2070000"       "2160000" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "2050000"       "2150000"       "2130000"       "2170000" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $feature</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          "test"          "test"          "test"          "test" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        "Group1"        "Group1"        "Group2"        "Group3" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   annTrack item 1   annTrack item 3   annTrack item 2   annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "annTrack item 1" "annTrack item 3" "annTrack item 2" "annTrack item 4" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "1"             "1"             "1"             "1" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $exonId</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   annTrack item 1   annTrack item 3   annTrack item 2   annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "annTrack item 1" "annTrack item 3" "annTrack item 2" "annTrack item 4" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $origExonId</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   annTrack item 1   annTrack item 3   annTrack item 2   annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "annTrack item 1" "annTrack item 3" "annTrack item 2" "annTrack item 4" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> annTrack item 1 annTrack item 3 annTrack item 2 annTrack item 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      "darkgray"      "darkgray"      "darkgray"      "darkgray" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $title</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Group1" "Group1" "Group2" "Group3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## DetailsAnnotationTrack</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span> <span class="co"># need to use grid grapics</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## generate two random distributions per row (probe/feature)</span></span>
<span class="r-in"><span class="co">## the difference between the distributions increases from probe 1 to 4</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span><span class="op">[</span>,<span class="fl">51</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">[</span>,<span class="fl">51</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span></span>
<span class="r-in"><span class="co">## rownames must be accessible by AnnotationTrack element identifier</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">identifier</span><span class="op">(</span><span class="va">annTrack</span>, <span class="st">"lowest"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## create a lattice density plot for the values (signals) of the two groups</span></span>
<span class="r-in"><span class="co">## as the chart must be placed into a pre-set grid view port we have to use</span></span>
<span class="r-in"><span class="co">## print without calling plot.new! Note, use a common prefix for all lattice.</span></span>
<span class="r-in"><span class="co">## Avoid wasting space by removing y-axis decorations.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Note, in this example 'm' will be found in the environment the 'details'</span></span>
<span class="r-in"><span class="co">## function is defined in. To avoid overwriting 'm' you should use a closure</span></span>
<span class="r-in"><span class="co">## or environment to access 'm'. </span></span>
<span class="r-in"><span class="va">details</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">identifier</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>signal<span class="op">=</span><span class="va">m</span><span class="op">[</span><span class="va">identifier</span>,<span class="op">]</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grp1"</span>,<span class="st">"grp2"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">densityplot</a></span><span class="op">(</span><span class="op">~</span><span class="va">signal</span>, group<span class="op">=</span><span class="va">group</span>, data<span class="op">=</span><span class="va">d</span>, main<span class="op">=</span><span class="va">identifier</span>,</span>
<span class="r-in">    scales<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>draw<span class="op">=</span><span class="cn">FALSE</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>draw<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">""</span>, xlab<span class="op">=</span><span class="st">""</span>,</span>
<span class="r-in">    <span class="op">)</span>, newpage<span class="op">=</span><span class="cn">FALSE</span>, prefix<span class="op">=</span><span class="st">"plot"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">deTrack</span> <span class="op">&lt;-</span> <span class="fu">AnnotationTrack</span><span class="op">(</span>range<span class="op">=</span><span class="va">gr</span>, genome<span class="op">=</span><span class="st">"hg19"</span>, chromosome<span class="op">=</span><span class="fl">7</span>,</span>
<span class="r-in">   name<span class="op">=</span><span class="st">"generic annotation with details per entry"</span>, stacking<span class="op">=</span><span class="st">"squish"</span>,</span>
<span class="r-in">   fun<span class="op">=</span><span class="va">details</span>, details.ratio<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">deTrack</span><span class="op">)</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"><span class="va">deTrack</span> <span class="op">&lt;-</span> <span class="fu">AnnotationTrack</span><span class="op">(</span>range<span class="op">=</span><span class="va">gr</span>, genome<span class="op">=</span><span class="st">"hg19"</span>, chromosome<span class="op">=</span><span class="fl">7</span>,</span>
<span class="r-in">   name<span class="op">=</span><span class="st">"generic annotation with details per entry"</span>,</span>
<span class="r-in">   stacking<span class="op">=</span><span class="st">"squish"</span>,fun<span class="op">=</span><span class="va">details</span>,</span>
<span class="r-in">    details.ratio<span class="op">=</span><span class="fl">1</span>, selectFun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="plotTracks.html">plotTracks</a></span><span class="op">(</span><span class="va">deTrack</span><span class="op">)</span></span>
<span class="r-plt img"><img src="AnnotationTrack-class-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Florian Hahne, Steffen Durinck, Robert Ivanek, Arne Mueller, Steve Lianoglou, Ge Tan, Lance Parsons, Shraddha Pai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

